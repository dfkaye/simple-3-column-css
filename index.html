<!DOCTYPE html>
<html>
  <head>
    <title>simple three-column css</title>
    <link rel='stylesheet' href='./css/3-column.css' />
    <link rel='stylesheet' href='./css/test-page.css' />
  </head>
  <body>
    <h1>three-column css test</h1>

    <p>
      Goal is to create a three-column markup with classes that need no changing 
      to re-order the columns.  Well, *one* container element's class must change,
      to allow the cascade/specifity to do the re-ordering.
    </p>
    
    <p>
      Two main obstacles are that 
      1) column widths must be set by page-specific rules, 
      2) column 3 width can not be percentage based (may be ems, though)
      3) (did I say two obstacles?) #3 is that nested 3-column layouts are doubly complicated.
      4) (another one?) #4 MS IE 6 *almost* lays out the nested structures - IE7 and up seem OK now.
    </p>
    
    <p>
      Prior art - Michael Bowers, "Pro CSS and HTML Design Patterns", APress, 2007.
    </p>
    
    <p>
      view the repo at 
      <a href='https://github.com/dfkaye/simple-3-column-css'>
        https://github.com/dfkaye/simple-3-column-css
      </a>
    </p>

    <h3>view the basic layouts:</h3>
    <div id='orders'>
      <a href="#123">123</a>
      <a href="#213">213</a>
      <a href="#312">312</a>
      <a href="#321">321</a>
      <a href="#132">132</a>
      <a href="#231">231</a>
    </div>
    
    <h3>loop through the layouts</h3>
    <button type='button' id='startButton'>start loop</button>
    <button type='button' id='stopButton'>stop loop</button>    

    <div class='layers'>
    
      <h2>simple three-column css</h2>
      <p>
        This test works cross-browser back to IE6.  The markup structure is fairly shallow.
      </p>
      <div id="simple" class="clearfix columns order-xyz">
        <div class="intercolumn">
          <div class="col-1">
            <h1>1. main section</h1>
            <p>main paragraph</p>
          </div>
          <div class="col-2">
            <h1>2. more section</h1>
            <p>more paragraph</p>
          </div>
        </div>
        <div class="col-3">
          <h1>3. related section</h1>
          <p>related paragraph</p>
        </div>
      </div>

      <h2>nested three-column css - in progress</h2>

      <div id="nested" class="nested clearfix columns order-xyz">
        <div class="intercolumn">
          <div class="col-1">
            <h2>nested-1</h2>
            <div id="nested-1" class="nested clearfix columns order-xyz">
              <div class="intercolumn">
                <div class="col-1">
                  <h1>1. main section</h1>
                  <p>main paragraph</p>
                </div>
                <div class="col-2">
                  <h1>2. more section</h1>
                  <p>more paragraph</p>
                </div>
              </div>
              <div class="col-3">
                <h1>3. related section</h1>
                <p>related paragraph</p>
              </div>
            </div>
          </div>
          <div class="col-2">
            <h2>nested-2</h2>
            <div id="nested-2" class="nested clearfix columns order-xyz">
              <div class="intercolumn">
                <div class="col-1">
                  <h1>1. main section</h1>
                  <p>main paragraph</p>
                </div>
                <div class="col-2">
                  <h1>2. more section</h1>
                  <p>more paragraph</p>
                </div>
              </div>
              <div class="col-3">
                <h1>3. related section</h1>
                <p>related paragraph</p>
              </div>
            </div>
          </div>
        </div>
        <div class="col-3">
          <h2>nested-3</h2>
          <div id="nested-3" class="nested clearfix columns order-xyz">
            <div class="intercolumn">
              <div class="col-1">
                <h1>1. main section</h1>
                <p>main paragraph</p>
              </div>
              <div class="col-2">
                <h1>2. more section</h1>
                <p>more paragraph</p>
              </div>
            </div>
            <div class="col-3">
              <h1>3. related section</h1>
              <p>related paragraph</p>
            </div>
          </div>
        </div>
      </div>      
    </div>
  
    <script>
    
      var tests = [
        document.getElementById('simple'),
        document.getElementById('nested'),
        document.getElementById('nested-1'),
        document.getElementById('nested-2'),
        document.getElementById('nested-3')
      ];
      
      var order = ['123', '132', '213', '231', '312', '321'];
      
      var o = 0;
      var t = 0;
      function loop() {
        var test = tests[t++];
        test.className = test.className.replace(/order-[\w]{3,3}/, 'order-' + order[o++]);
        o < order.length || (o = 0);
        t < tests.length || (t = 0);
      }
      var interval;
      function startLoop() {
        interval = setInterval(loop, 750);
        startButton.disabled = true;
        stopButton.disabled = false;
      }
      function stopLoop() {
        clearInterval(interval);
        interval = null;
        stopButton.disabled = true;
        startButton.disabled = false;        
      }
      var startButton = document.getElementById('startButton');
      var stopButton = document.getElementById('stopButton');
      if (startButton.addEventListener) {
        startButton.addEventListener('click', startLoop, false);
        stopButton.addEventListener('click', stopLoop, false);
      } else if (startButton.attachEvent) {
        startButton.attachEvent('onclick', startLoop);
        stopButton.attachEvent('onclick', stopLoop);
      }
      //var t = 0;
      
      function next(order) {
        //var test = tests[t];
        //test.className = test.className.replace(/order-[\w]{3,3}/, 'order-' + order);
        //t < tests.length || (t = 0);
        
        for ( var i = 0; i < tests.length; i++) {
          var test = tests[i];
          test.className = test.className.replace(/order-[\w]{3,3}/, 'order-' + order);
        }
      }

      function showOrder(e) {
        var target = e.target || e.srcElement;
        var order = target.getAttribute('href');      
        if (!order) {
          return;
        }
        next(order.split('#')[1]);
      }

      var orders = document.getElementById('orders');
      
      if (orders.addEventListener) {
        orders.addEventListener('click', showOrder, false);
      } else if (orders.attachEvent) {
        orders.attachEvent('onclick', showOrder);
      }

    </script>
  </body>
</html>
